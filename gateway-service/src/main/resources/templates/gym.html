<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>장소 관리</title>-->
<!--    <link rel="stylesheet" href="/css/style.css">-->
<!--    <script src="/js/gym.js" defer></script>-->
<!--    <script src="/js/message.js" defer></script>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; 상단 네비게이션 &ndash;&gt;-->
<!--<nav class="navbar">-->
<!--    <div class="container">-->
<!--        <a class="navbar-brand" href="/">MSA 프로젝트</a>-->
<!--        <div>-->
<!--            <a class="nav-link" href="/customers" style="margin-right: 20px; color: white;">고객</a>-->
<!--            <a class="nav-link" href="/gym" style="color: #f1c40f;">체육관</a>-->
<!--        </div>-->
<!--    </div>-->
<!--</nav>-->

<!--<div class="container">-->
<!--    <h1 style="margin-bottom: 1.5rem;">🏋️ 장소 관리 프로그램</h1>-->

<!--    &lt;!&ndash; 입력 폼 &ndash;&gt;-->
<!--    <div class="card">-->
<!--        <h3>새 종목 등록</h3>-->
<!--        <div class="form-group">-->
<!--            <label for="name">위치</label>-->
<!--            <input type="text" id="name" class="form-control" placeholder="예: 헬스센터 3호관">-->
<!--        </div>-->
<!--        <div class="form-group">-->
<!--            <label for="item">종목</label>-->
<!--            <input type="text" id="item" class="form-control" placeholder="예: 헬스, 요가 등">-->
<!--        </div>-->
<!--        <button class="btn btn-primary" onclick="addGym()">추가</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; 체육관 목록 &ndash;&gt;-->
<!--    <div class="card">-->
<!--        <h3>체육관 목록</h3>-->
<!--        <table class="table" id="gym-table">-->
<!--            <thead>-->
<!--            <tr>-->
<!--                <th style="width: 10%;">ID</th>-->
<!--                <th style="width: 30%;">위치</th>-->
<!--                <th style="width: 30%;">종목</th>-->
<!--                <th style="width: 30%;">작업</th>-->
<!--            </tr>-->
<!--            </thead>-->
<!--            <tbody></tbody>-->
<!--        </table>-->
<!--    </div>-->

<!--    &lt;!&ndash; 메시지 목록 &ndash;&gt;-->
<!--    <div class="card">-->
<!--        <h3>받은 메시지</h3>-->
<!--        <table class="table" id="message-table">-->
<!--            <thead>-->
<!--            <tr>-->
<!--                <th style="width: 10%;">ID</th>-->
<!--                <th style="width: 60%;">내용</th>-->
<!--                <th style="width: 30%;">작업</th>-->
<!--            </tr>-->
<!--            </thead>-->
<!--            <tbody></tbody>-->
<!--        </table>-->
<!--    </div>-->
<!--    &lt;!&ndash; customer 리스트 &ndash;&gt;-->
<!--    <div>-->
<!--        <h4>📜 customer</h4>-->
<!--        <div id="customerList" class="row"></div>-->
<!--    </div>-->
<!--</div>-->
<!--<script>-->
<!--    console.log("🚀 JS loaded once"); // 중복 로드 디버그용-->
<!--    const apiUrl = "/api/cusmsg";-->
<!--    // ✅ 메시지 목록 로드-->
<!--    async function loadMessages() {-->
<!--        try {-->
<!--            const res = await fetch(apiUrl);-->
<!--            const messages = await res.json();-->

<!--            const list = document.getElementById("customerList");-->
<!--            list.innerHTML = "";-->

<!--            messages.reverse().forEach(msg => {-->
<!--                const card = document.createElement("div");-->
<!--                card.className = "col-md-4 mb-3";-->
<!--                card.innerHTML = `-->
<!--                    <div class="card p-3">-->
<!--                        <h5>${msg.name}</h5>-->
<!--                        <p><strong>Phone:</strong> ${msg.phone}</p>-->
<!--                        <p><strong>Cusnum:</strong> ${msg.cusnum}</p>-->
<!--                    </div>-->
<!--                `;-->
<!--                list.appendChild(card);-->
<!--            });-->
<!--        } catch (err) {-->
<!--            console.error("❌ Failed to load messages:", err);-->
<!--        }-->
<!--    }-->
<!--    // ✅ 페이지 로드 시 초기화-->
<!--    window.addEventListener("DOMContentLoaded", async () => {-->
<!--        await loadMessages();-->
<!--        initFormHandler();-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>장소 관리</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/gym.js" defer></script>
    <script src="/js/message.js" defer></script>
</head>
<body>
<nav class="navbar">
    <div class="container">
        <a class="navbar-brand" href="/">MSA 프로젝트</a>
        <div>
            <a class="nav-link" href="/customers" style="margin-right: 20px; color: white;">고객</a>
            <a class="nav-link" href="/gym" style="color: #f1c40f;">체육관</a>
        </div>
    </div>
</nav>

<div class="container">
    <h1 style="margin-bottom: 1.5rem;">🏋️ 장소 관리 프로그램</h1>

    <div class="card p-3 mb-3"> <h3>새 종목 등록</h3>
        <div class="form-group mb-2"> <label for="name">위치</label>
            <input type="text" id="name" class="form-control" placeholder="예: 헬스센터 3호관">
        </div>
        <div class="form-group mb-3"> <label for="item">종목</label>
            <input type="text" id="item" class="form-control" placeholder="예: 헬스, 요가 등">
        </div>
        <button class="btn btn-primary" onclick="addGym()">추가</button>
    </div>

    <div class="card p-3 mb-3"> <h3>체육관 목록</h3>
        <table class="table" id="gym-table">
            <thead>
            <tr>
                <th style="width: 10%;">ID</th>
                <th style="width: 30%;">위치</th>
                <th style="width: 30%;">종목</th>
                <th style="width: 30%;">작업</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="card p-3 mb-3"> <h3>받은 메시지</h3>
        <table class="table" id="message-table">
            <thead>
            <tr>
                <th style="width: 10%;">ID</th>
                <th style="width: 60%;">내용</th>
                <th style="width: 30%;">작업</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <div class="card p-3"> <h4>📜 customer</h4>
        <div id="customerList" class="row"></div>
    </div>
</div>
<script>
    console.log("🚀 JS loaded once");
    const apiUrl = "/api/cusmsg"; // 컨트롤러와 일치하는 주소

    // ✅ 메시지 목록 로드 함수
    async function loadMessages() {
        try {
            const res = await fetch(apiUrl); // GET /api/cusmsg 호출
            if (!res.ok) {
                throw new Error(`Failed to fetch: ${res.status}`);
            }
            const messages = await res.json();

            const list = document.getElementById("customerList");
            list.innerHTML = "";

            if (messages.length === 0) {
                list.innerHTML = "<p>받은 메시지가 없습니다.</p>";
                return;
            }

            messages.reverse().forEach(msg => {
                const card = document.createElement("div");
                // Bootstrap 그리드와 카드 스타일 적용
                card.className = "col-md-4 mb-3";
                card.innerHTML = `
                    <div class="card p-3">
                        <h5>${msg.name}</h5>
                        <p><strong>Phone:</strong> ${msg.phone}</p>
                        <p><strong>Cusnum:</strong> ${msg.cusnum}</p>
                    </div>
                `;
                list.appendChild(card);
            });
        } catch (err) {
            console.error("❌ Failed to load messages:", err);
            document.getElementById("customerList").innerHTML =
                "<p style='color:red;'>메시지를 불러오는 데 실패했습니다.</p>";
        }
    }

    // ✅ 페이지 로드 시 초기화
    window.addEventListener("DOMContentLoaded", async () => {
        // 2. loadMessages()만 호출
        await loadMessages();

        // 3. initFormHandler() 호출 삭제
        // initFormHandler();
    });
</script>
</body>
</html>
